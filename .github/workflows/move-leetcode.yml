name: Move LeetCode Solutions

on:
  workflow_dispatch:
  push:
    branches:
      - main
      - master
    paths-ignore:
      - 'LeetCode/**'
      - '.github/**'
      - 'ë°±ì¤€/**'
      - 'SWEA/**'
      - 'í”„ë¡œê·¸ë˜ë¨¸ìŠ¤/**'

jobs:
  move-files:
    runs-on: ubuntu-latest
    permissions:
      contents: write
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
        with:
          fetch-depth: 0
          token: ${{ secrets.GITHUB_TOKEN }}

      - name: Pull latest changes
        run: |
          git pull origin main --rebase

      - name: Move LeetCode solutions
        run: |
          mkdir -p LeetCode
          
          echo "=== Looking for LeetCode problems ==="
          moved=false
          
          # ë£¨íŠ¸ì— ìˆëŠ” ìˆ«ìë¡œ ì‹œì‘í•˜ëŠ” ëª¨ë“  ë””ë ‰í† ë¦¬ ì°¾ê¸°
          for dir in [0-9]*; do
            if [ -d "$dir" ] && [ "$dir" != "LeetCode" ]; then
              # ì´ë¯¸ LeetCode í´ë”ì— ìˆìœ¼ë©´ ì‚­ì œ í›„ ì´ë™
              if [ -d "LeetCode/$dir" ]; then
                echo "Removing existing LeetCode/$dir"
                rm -rf "LeetCode/$dir"
              fi
              echo "Moving: $dir to LeetCode/"
              mv "$dir" "LeetCode/"
              moved=true
            fi
          done
          
          # í•˜ì´í”ˆì´ í¬í•¨ëœ ë””ë ‰í† ë¦¬ë„ ì²´í¬
          for dir in *-*; do
            if [ -d "$dir" ] && [[ "$dir" =~ ^[a-z] ]] && [ "$dir" != "LeetCode" ]; then
              if [ -d "LeetCode/$dir" ]; then
                echo "Removing existing LeetCode/$dir"
                rm -rf "LeetCode/$dir"
              fi
              echo "Moving: $dir to LeetCode/"
              mv "$dir" "LeetCode/"
              moved=true
            fi
          done
          
          if [ "$moved" = true ]; then
            echo "Successfully moved directories"
          else
            echo "No directories to move"
          fi

      - name: Commit and Push changes
        run: |
          git config user.name 'github-actions[bot]'
          git config user.email 'github-actions[bot]@users.noreply.github.com'
          
          if [ -n "$(git status --porcelain)" ]; then
            git add -A
            git commit -m "ğŸ“ Auto-organize: Move LeetCode solutions to LeetCode folder"
            git pull --rebase origin main
            git push
          else
            echo "No changes to commit"
          fi
